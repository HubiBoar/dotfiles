x-base: &base
  network_mode: "host"
  environment:
    PROFILE: ${PROFILE}
    STATE_PATH: "$PWD/profiles/${PROFILE}/state"
    STATE_HOME_PATH: "$PWD/profiles/${PROFILE}/state/root"
  volumes: 
    - ./profiles/${PROFILE}/state/root/.local/share/nvim/harpoon:/root/.local/share/nvim/harpoon
    - ./profiles/${PROFILE}/state/root/.ssh:/root/.ssh
    - ./profiles/${PROFILE}/state/root/.azure:/root/.azure
    - ./profiles/${PROFILE}/state/root/.aspnet:/root/.aspnet
    - ./profiles/${PROFILE}/state/root/.config/gh:/root/.config/gh
    - ./profiles/${PROFILE}/lazy-lock.json:/root/.config/nvim/lazy-lock.json
    - /var/run/docker.sock:/var/run/docker.sock
    - ~/dotfiles:/root/dotfiles
    - ~/projects:/root/projects
    - /etc/hosts:/etc/hosts
    - ~/.docker:/root/.docker
    - ~/.password-store:/root/.password-store
    - ~/.gnupg:/root/.gnupg

services:
    base:
      image: cde/base 
      build:
        context: ./profiles/base

    go:
      <<: *base 
      container_name: cde-go
      build: 
        context: ./profiles/go

    dotnet:
      <<: *base 
      container_name: cde-dotnet
      build: 
        context: ./profiles/dotnet

    nis:
      <<: *base 
      container_name: cde-nis
      build:
        context: ./profiles/nis

    bsure:
      <<: *base 
      container_name: cde-bsure
      build:
        context: ./profiles/bsure
